<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>登录页面</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--<meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="layui/css/layui.css" media="all">-->

    <!-- Favicon -->
    <link rel="icon" href="dist/media/img/favicon.png" type="image/png">

    <link rel="stylesheet" href="vendor/enjoyhint/enjoyhint.css">

    <!-- App styles -->
    <link rel="stylesheet" href="dist/css/app.min.css">

    <link rel="stylesheet" href="css/main.css" />
</head>

<body>
<div class="container" id="aindex">
    <div class="row clearfix" >
        <div class="col-md-12 column">
            <nav class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
                    <a class="navbar-brand" href="#">iFav</a>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">

                    </ul>
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" v-model="searchData" />
                        </div> <button type="submit" class="btn btn-default">搜索</button>
                    </form>
                    <ul class="nav navbar-nav navbar-right">

                        <!--<li>
                            <img onmousemove="bigImg(this)" onmouseout="normalImg(this)" id="signal" src="img/timg.jpg" />
                        </li>-->
                        <li class="dropdown">

                            <img href="#" data-toggle="dropdown" id="signal" src="img/timg.jpg" class="img-circle">
                            <ul class="dropdown-menu">
                                <li class="list-inline-item" data-toggle="tooltip" title="New group">
                                    <a class="btn btn-outline-light" href="#" data-toggle="modal" data-target="#newGroup">
                                        添加收藏

                                    </a>
                                </li>
                                <li class="list-inline-item" data-toggle="tooltip" title="New group">
                                    <a class="btn btn-outline-light" href="#" data-toggle="modal" data-target="#newGroup">
                                        修改头像

                                    </a>
                                </li>

                                <li class="list-inline-item" data-toggle="tooltip" title="New group">
                                    <a class="btn btn-outline-light" href="#" data-toggle="modal" data-target="#newGroup">
                                        退出登录
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="./login.html"><span class="glyphicon glyphicon-log-in"></span> 登录</a>
                        </li>
                        <li>
                            <a href="./register.html"><span class="glyphicon glyphicon-user"></span> 注册</a>
                        </li>

                    </ul>
                </div>

                <ul class="breadcrumb" data-parent="#accordion">
                    <li>
                        <a href="recommend.html" class="active">推荐收藏</a>
                    </li>
                    <li>
                        <a href="#">我的收藏</a>
                    </li>
                    <li>
                        <a href="#">2020</a>
                    </li>
                    <li class="active">十二月</li>
                    <li class="active">{{province}}</li>
                    <li class="active">{{city}}</li>
                </ul>
                <!--
                    <div v-for="item,index in subjects">
                    {{ index }} {{ item }}
                </div>
                -->
                <div data-spy="scroll" class="nav-tabs" data-target="#navbar-example" data-offset="0" style="height:560px;overflow:auto; position: relative;">

<!--                    <div  id="div" v-for="item in favs" :key="index" >-->
<!--                        <img  style="margin-left: 15px;" src="img/baidu.jpg">-->
<!--                        <div id="describe">-->
<!--                            <p >{{item.mfdesc}}</p>-->
<!--                        </div>-->
<!--                        <div id="maintitle">-->
<!--                            <a v-bind:href="item.mfurl" id="incoll1">{{item.mfname}}</a>-->
<!--                        </div>-->

<!--                        <div id="starmod">-->
<!--                            <input type="checkbox" id="fav-btn" >-->
<!--                            <label for="fav-btn" >-->
<!--                                <svg id="star" t="1562567183725" class="icon" viewBox="0 0 1100 850" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1976" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">-->
<!--                                    <path d="M956 398.496q-8-23.488-26.496-39.008t-42.496-19.488l-204.992-31.008-92-195.008q-11.008-24-32.992-36.992Q536.032 64 512.032 64t-44.992 12.992q-22.016 12.992-32.992 36.992l-92 195.008-204.992 31.008q-24 4-42.496 19.488t-26.496 39.008-2.496 47.008 22.496 41.504l151.008 154.016-36 218.016q-6.016 40 20 70.496t66.016 30.496q22.016 0 42.016-11.008l180.992-100 180.992 100q20 11.008 42.016 11.008 40 0 66.016-30.496t20-70.496l-36-218.016 151.008-154.016q16.992-18.016 22.496-41.504t-2.496-47.008z" p-id="1977"></path>-->
<!--                                </svg>-->
<!--                            </label>-->

<!--                        </div>-->
<!--                    </div>-->


                    <div  id="div" v-for="(item,index) in Newitems" :key="index" >
                        <img  style="margin-left: 15px;" src="img/baidu.jpg">
                        <div id="describe">
                            <p >{{item.mfdesc}}</p>
                        </div>
                        <div id="maintitle">
                            <a v-bind:href="item.mfurl" id="incoll1">{{item.name}}</a>
                        </div>

                        <div id="starmod">
                            <input type="checkbox" id="fav-btn" >
                            <label for="fav-btn" >
                                <svg id="star" t="1562567183725" class="icon" viewBox="0 0 1100 850" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1976" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
                                    <path d="M956 398.496q-8-23.488-26.496-39.008t-42.496-19.488l-204.992-31.008-92-195.008q-11.008-24-32.992-36.992Q536.032 64 512.032 64t-44.992 12.992q-22.016 12.992-32.992 36.992l-92 195.008-204.992 31.008q-24 4-42.496 19.488t-26.496 39.008-2.496 47.008 22.496 41.504l151.008 154.016-36 218.016q-6.016 40 20 70.496t66.016 30.496q22.016 0 42.016-11.008l180.992-100 180.992 100q20 11.008 42.016 11.008 40 0 66.016-30.496t20-70.496l-36-218.016 151.008-154.016q16.992-18.016 22.496-41.504t-2.496-47.008z" p-id="1977"></path>
                                </svg>
                            </label>

                        </div>
                    </div>



                </div>
        </div>
    </div>
</div>

<!-- 添加收藏 -->
<div class="modal fade" id="newGroup" tabindex="-1" role="dialog" aria-hidden="true" style="position: absolute;top: 15%;">
    <div class="modal-dialog modal-dialog-centered modal-dialog-zoom" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" style="position: absolute; margin-top: 1%;"> <i data-feather="plus"></i>
                    添加收藏
                </h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="ti-close"></i>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="group_name" class="col-form-label">收藏名</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="group_name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="group_name" class="col-form-label">网址链接</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="group_name">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="description" class="col-form-label">描述</label>
                        <textarea class="form-control" id="description"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">创建</button>
            </div>
        </div>
    </div>
</div>

<div id="fade" class="box_2"></div>

<footer>

    <center>
        <p>Copyright © 2020
            <a target="_blank" href="#">iFav</a>
        </p>
    </center>

</footer>

<script src="js/main.js"></script>
<script src="js/jquery-3.4.1.min.js"></script>
<script src="vendor/bundle.js"></script>
<script src="vendor/feather.min.js"></script>
<script src="vendor/enjoyhint/enjoyhint.min.js"></script>
<script src="http://api.map.baidu.com/api?v=2.0&ak=djANiT0AFeIK2FNLZxY9zvCSliWC3bL6"></script>
<script type="text/javascript" src="js/axios.js"></script>
<script type="text/javascript" src="js/vue.js"></script>

<!-- App scripts -->
<script src="dist/js/app.min.js"></script>
<!--<script type="text/javascript" src="js/refire.js" ></script>-->
<!--<script src="layui/layui.js" charset="utf-8"></script>-->
<script>
    var hash=window.location.hash;
    var muid = hash.replace("#", '');
    var vm = new Vue({
        el: '#aindex',
        data: {
            searchData:"",
            province: "",
            city: "",
            temperature:"",
            weatherImage:"",
            favs:[],
            muid:muid,
            mfname:"",
            mfdesc:"",
            mfurl:"",
            mid:null,

            test:[{name:"000000",mfdesc:"张小四很帅，老郭很酷",mfurl:"https://www.baidu.com/"},
                {name:"000000"},{name:"000000"},
                {name:"力扣"},{name:"谷阿哥"},
                {name:"000000"},{name:"000000"},
                {name:"阿里巴巴"},
                {name:"000000"},{name:"谷歌"},
                {name:"百度"},{name:"000000"},
                {name:"000000"},{name:"000000"},
                {name:"000000"},
                {name:"滴滴出行"},{name:"我爱扣"},
                {name:"000000"},{name:"000000"},
                {name:"000000"},{name:"000000"},
                {name:"Hello,World"}]
        },


        //mounted:在模板渲染成html后调用，通常是初始化页面完成后，
        //再对html的dom节点进行一些需要的操作。
        mounted() {
            this.getLocation();
            this.findByMuid(this.muid);
        },
        computed:{
            Newitems: function(){
                alert("我是computed")
                var _this = this;
                var Newitems = [];
                _this.test.map(function(item){
                    if(item.name.search(_this.searchData)!=-1){
                        Newitems.push(item);
                    }
                });
                console.log(Newitems);
                return  Newitems;
            }
        },
        methods: {
            addFav: function(){
                var self=this;
                $.ajax({
                    type:"POST",
                    url:"/myfav/add",
                    data:{muid:this.muid,mfname:self.mfname,mfurl:self.mfurl,mfdesc:self.mfdesc},
                    dataType:"json",
                    success:function(result){
                        if(result.code==1){
                            alert(result.data);
                            window.location.href="index.html";
                        }else{
                            alert("添加失败")
                        }
                    }
                });
            },
            //根据mid删除收藏
            deleteByMid: function(){
                var self=this;
                $.ajax({
                    type:"POST",
                    url:"/myfav/delete",
                    data:{mid:this.mid},
                    dataType:"json",
                    success:function(result){
                        if(result.code==1){
                            alert("取消收藏成功");
                        }else{
                            alert(result.data);
                        }
                    }
                })
            },
            //获取地理位置
            getLocation: function() {
                var self = this;
                //获取当前城市
                var geolocation = new BMap.Geolocation();
                geolocation.getCurrentPosition(function(r) {
                    if(this.getStatus() == BMAP_STATUS_SUCCESS) {
                        var province = r.address.province; //返回当前省份
                        var city = r.address.city; //返回当前城市
                        self.province = province;
                        self.city = city;
                        console.log(province + "," + city)
                        var _this=this;
                        $.ajax({
                            type: "POST",
                            url: "/weather/",
                            data: {
                                province:this.province,
                                city:this.city
                            },
                            dataType: "json",
                            success: function(result) {
                                if(result.code == 1) {
                                    //self.temperature=result.
                                    //self.weatherImage=result
                                }
                            }
                        });
                    }
                });
            },
            //根据muid查询
            findByMuid: function(muid){
                var self=this;

                $.ajax({
                    type:"POST",
                    url:"/myfav/findById",
                    data:{muid:this.muid},
                    dataType:"json",
                    success:function(result){

                        if(result.code==1){
                            this.test=result.data;
                            console.log(this.favs)
                        }else{
                            alert("请登录");
                        }
                    }
                })
            }
        }
    });
</script>
</body>

</html>